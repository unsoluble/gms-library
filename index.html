<html>

<head>
	<link type="text/css" rel="stylesheet" href="jquery.qtip.min.css" />
	<link href='https://fonts.googleapis.com/css?family=Open Sans' rel='stylesheet'>
</head>

<body>
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js"></script>
	<script type="text/javascript" src="jquery.qtip.min.js"></script>
	
	<style type="text/css">
		.cover {
			object-fit: cover;
			width: 100px;
			height: 150px;
			margin: 18px;
			padding: 0px;
			box-shadow: 0px 3px 8px #aaa;
		}
		.hidden {
			display: none;
			font-size: 1.6em;
			line-height: 1.4em;
			text-align: center;
			font-family: 'Open Sans';
		}
		.author {
			font-size: 0.8em;
			font-style: italic;
		}
	</style>
	
	<script type="text/javascript">
	
		$(document).ready(function(){
			$.ajax({
				url: 'https://www.librarything.com/api_getdata.php?userid=unsoluble&key=2337767339&resultsets=books,bookdates&max=100&booksort=entry',
				dataType: 'jsonp',
				success: function(result){
					var text = '';
					var numBooks = 12;
					var arr = $.map(result.books, function(el) { return el });
					
					function getUnique(count) {
						var tmp = arr.slice(arr);
						var ret = [];

						for (var i = 0; i < count; i++) {
							var index = Math.floor(Math.random() * tmp.length);
							var removed = tmp.splice(index, 1);
							ret.push(removed[0]);
						}
						return ret;
					}
					
					var subset = getUnique(20);
					let i = 0;
					let soFar = 0;
					
					while (soFar < numBooks) {
						if (subset[i].cover.indexOf("librarything") >=0 ) {
							i++;
						} else {
							text += '<img class="cover" src="' + subset[i].cover + '" />';
							text += '<div class="hidden">' + subset[i].title + '<br><span class="author">by ' + subset[i].author_fl + '</span></div>';
							i++;
							soFar++;
						}
					}
					$('#books').html(text);
					$('img').each(function() {
						$(this).qtip({
							content: {
								text: $(this).next('div')
							},
							position: {
								my: 'top center',
								at: 'center',
								target: $(this),
								viewport: $(window),
								adjust: {
									method: 'shift none'
								}
							},
							show: {
								
							},
							hide: {
								event: 'mouseleave',
								fixed: true
							},
							style: {
								classes: 'qtip-light qtip-rounded'
							}
						});
					});
				}
			});
            
			
		});
		
		
            
            
	</script>
	
	<div id="books"></div>
	
</body>
</html>